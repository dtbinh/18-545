# Preference setting overrides
gui_create_pref_key -category {Globals} -key {load_detail_for_funcov} -value_type {bool} -value {false}

# State setting overrides
gui_state_default_create -off -ini
gui_set_state_value -category Globals -key recent_databases -value {{gui_open_db -file /afs/ece.cmu.edu/usr/rmacdona/341/Homework0/0.sv -design V1}}
gui_set_state_value -category Globals -key recent_sessions -value {{gui_load_session -file /afs/ece.cmu.edu/usr/rmacdona/18-545/session.inter.vpd.tcl -ignore_errors} {gui_load_session -file /afs/ece.cmu.edu/usr/rmacdona/18-545/session.inter.vpd.tcl}}
gui_set_state_value -category Layout -key child_console_size_x -value 1437
gui_set_state_value -category Layout -key child_console_size_y -value 176
gui_set_state_value -category Layout -key child_data_coltype -value 135
gui_set_state_value -category Layout -key child_data_colvalue -value 49
gui_set_state_value -category Layout -key child_data_colvariable -value 151
gui_set_state_value -category Layout -key child_data_size_x -value 305
gui_set_state_value -category Layout -key child_data_size_y -value 711
gui_set_state_value -category Layout -key child_driver_size_x -value 1145
gui_set_state_value -category Layout -key child_driver_size_y -value 179
gui_set_state_value -category Layout -key child_hier_colhier -value 205
gui_set_state_value -category Layout -key child_hier_size_x -value 274
gui_set_state_value -category Layout -key child_hier_size_y -value 711
gui_set_state_value -category Layout -key child_source_docknewline -value false
gui_set_state_value -category Layout -key child_source_pos_x -value {-2}
gui_set_state_value -category Layout -key child_source_pos_y -value {-15}
gui_set_state_value -category Layout -key child_source_size_x -value 861
gui_set_state_value -category Layout -key child_source_size_y -value 706
gui_set_state_value -category Layout -key child_wave_colname -value 171
gui_set_state_value -category Layout -key child_wave_colvalue -value 171
gui_set_state_value -category Layout -key child_wave_left -value 347
gui_set_state_value -category Layout -key child_wave_right -value 845
gui_set_state_value -category Layout -key main_pos_x -value 19
gui_set_state_value -category Layout -key main_pos_y -value 102
gui_set_state_value -category Layout -key main_size_x -value 1456
gui_set_state_value -category Layout -key main_size_y -value 1096
gui_set_state_value -category Layout -key stand_source_child_docknewline -value false
gui_set_state_value -category Layout -key stand_source_child_pos_x -value {-2}
gui_set_state_value -category Layout -key stand_source_child_pos_y -value {-15}
gui_set_state_value -category Layout -key stand_source_child_size_x -value 633
gui_set_state_value -category Layout -key stand_source_child_size_y -value 769
gui_set_state_value -category Layout -key stand_wave_child_docknewline -value false
gui_set_state_value -category Layout -key stand_wave_child_pos_x -value {-2}
gui_set_state_value -category Layout -key stand_wave_child_pos_y -value {-15}
gui_set_state_value -category Layout -key stand_wave_child_size_x -value 1202
gui_set_state_value -category Layout -key stand_wave_child_size_y -value 924
gui_set_state_value -category Layout -key stand_wave_top_pos_x -value 167
gui_set_state_value -category Layout -key stand_wave_top_pos_y -value 103
gui_set_state_value -category Layout -key stand_wave_top_size_x -value 1364
gui_set_state_value -category Layout -key stand_wave_top_size_y -value 1165
gui_create_state_key -category FindDialog -key m_pMatchCase -value_type bool -value false
gui_create_state_key -category FindDialog -key m_pMatchWord -value_type bool -value false
gui_create_state_key -category FindDialog -key m_pUseCombo -value_type string -value {}
gui_create_state_key -category FindDialog -key m_pWrapAround -value_type bool -value true
gui_create_state_key -category Widget_History -key TopLevel.1|qt_left_dock|DockWnd2|DLPane.1|pages|Data.1|hbox|textfilter -value_type string -value result
gui_create_state_key -category Widget_History -key TopLevel.2|EkTopVbox|wndWorkspace|qt_workspacechild2|Wave.1|left|filterVBox|controlHBox|unnamed -value_type string -value conv
gui_create_state_key -category Widget_History -key {dlgSimSetup|m_setupTab|tab pages|SimTab|m_VPDCombo} -value_type string -value inter.vpd
gui_create_state_key -category Widget_History -key {dlgSimSetup|m_setupTab|tab pages|SimTab|m_argsCombo} -value_type string -value {{ -ucligui}}
gui_create_state_key -category Widget_History -key {dlgSimSetup|m_setupTab|tab pages|SimTab|m_curDirCombo} -value_type string -value /afs/ece.cmu.edu/usr/rmacdona/18-545
gui_create_state_key -category Widget_History -key {dlgSimSetup|m_setupTab|tab pages|SimTab|m_exeCombo} -value_type string -value {/afs/ece.cmu.edu/usr/rmacdona/18-545/simv ./simv}
gui_state_default_create -off

# Begin command logging
gui_sim_run Ucli -exe ./simv -args {-ucligui  } -dir .
dump -add { tb_camera } -depth 0 -scope "."
run
gui_list_expand -id  Hier.1   tb_camera
gui_list_select -id Hier.1 -selected  { tb_camera.cc   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk  tb_camera.cc.rst  tb_camera.cc.v0  tb_camera.cc.v1  tb_camera.cc.v2  tb_camera.cc.keys   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk  tb_camera.cc.rst  tb_camera.cc.v0  tb_camera.cc.v1  tb_camera.cc.v2  tb_camera.cc.keys  tb_camera.cc.rendering_done   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk  tb_camera.cc.rst  tb_camera.cc.v0  tb_camera.cc.v1  tb_camera.cc.v2  tb_camera.cc.keys  tb_camera.cc.rendering_done  tb_camera.cc.render_frame   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk  tb_camera.cc.rst  tb_camera.cc.v0  tb_camera.cc.v1  tb_camera.cc.v2  tb_camera.cc.keys  tb_camera.cc.rendering_done  tb_camera.cc.render_frame  tb_camera.cc.E   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.clk  tb_camera.cc.rst  tb_camera.cc.v0  tb_camera.cc.v1  tb_camera.cc.v2  tb_camera.cc.keys  tb_camera.cc.rendering_done  tb_camera.cc.render_frame  tb_camera.cc.E  tb_camera.cc.rendering   }
gui_list_select -id Data.1 { tb_camera.cc.pressed   }
gui_list_select -id Data.1 { tb_camera.cc.ld_key_val   }
gui_list_select -id Data.1 { {tb_camera.cc.mv_cnt[31:0]}   }
gui_list_select -id Data.1 { tb_camera.cc.stop_cnt   }
gui_list_select -id Data.1 { tb_camera.cc.start_cnt0   }
gui_list_select -id Data.1 { tb_camera.cc.start_cnt25   }
gui_list_select -id Data.1 { tb_camera.cc.clr_cnt   }
gui_open_window Wave
gui_list_add -id Wave.1 -from Data.1 { tb_camera.cc.clk tb_camera.cc.rst tb_camera.cc.v0 tb_camera.cc.v1 tb_camera.cc.v2 tb_camera.cc.keys tb_camera.cc.rendering_done tb_camera.cc.render_frame tb_camera.cc.E tb_camera.cc.rendering tb_camera.cc.pressed tb_camera.cc.ld_key_val {tb_camera.cc.mv_cnt[31:0]} tb_camera.cc.stop_cnt tb_camera.cc.start_cnt0 tb_camera.cc.start_cnt25 tb_camera.cc.clr_cnt } -insertionbar
gui_list_expand -id  Hier.1   tb_camera.cc
gui_list_select -id Hier.1 -selected  { tb_camera.cc.ff   }
gui_list_select -id Hier.1 -selected  { tb_camera.cc.cd   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.key[2:0]}   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}  tb_camera.cc.cd.nextCam   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}  tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}  tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x  tb_camera.cc.cd.nc_y   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}  tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x  tb_camera.cc.cd.nc_y  {tb_camera.cc.cd.move_val[31:0]}   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.cd.cnt[31:0]}   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.cd.nc_x   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.cd.nextCam   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x  tb_camera.cc.cd.nc_y   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.cd.nextCam  tb_camera.cc.cd.nc_x  tb_camera.cc.cd.nc_y  tb_camera.cc.cd.nc_z   }
gui_list_add -id Wave.1 -from Data.1 { tb_camera.cc.cd.nc_x tb_camera.cc.cd.nc_y tb_camera.cc.cd.nc_z tb_camera.cc.cd.nextCam } -insertionbar
gui_zoom -window  Wave.1  -factor 0.5
gui_zoom -window  Wave.1  -factor 0.5
gui_zoom -window  Wave.1  -factor 0.5
gui_zoom -window  Wave.1  -factor 0.5
gui_wv_zoom_timerange -id  Wave.1 0 2833
gui_wv_zoom_timerange -id  Wave.1 0 2369
gui_wv_zoom_timerange -id  Wave.1 0 2200
gui_wv_zoom_timerange -id  Wave.1 0 2149
gui_marker_move -id  Wave.1 C1 284
gui_list_select -id Wave.1 -selected  { tb_camera.cc.render_frame   }
gui_list_select -id Wave.1 -selected  { tb_camera.cc.rendering_done   }
gui_marker_move -id  Wave.1 C1 2010
gui_list_select -id Wave.1 -selected  { tb_camera.cc.pressed   }
gui_list_select -id Wave.1 -selected  { tb_camera.cc.rendering   }
gui_list_select -id Hier.1 -selected  {  }
gui_list_select -id Hier.1 -selected  { tb_camera.cc   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.W   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.W  {tb_camera.cc.CS1[1:0]}   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.W  {tb_camera.cc.CS1[1:0]}  {tb_camera.cc.NS1[1:0]}   }
gui_list_select -id Data.1 -selected  { tb_camera.cc.NS0   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.CS1[1:0]}   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.CS1[1:0]}  {tb_camera.cc.NS1[1:0]}   }
gui_list_add -id Wave.1 -from Data.1 { {tb_camera.cc.CS1[1:0]} {tb_camera.cc.NS1[1:0]} } -insertionbar
gui_wv_zoom_timerange -id  Wave.1 1683 2113
gui_wv_zoom_timerange -id  Wave.1 1912 2118
gui_marker_move -id  Wave.1 C1 2020
gui_marker_move -id  Wave.1 C1 2010
gui_marker_move -id  Wave.1 C1 2020
gui_marker_move -id  Wave.1 C1 2010
gui_list_select -id Wave.1 -selected  { tb_camera.cc.clr_cnt   }
gui_wv_zoom_timerange -id  Wave.1 1911 2189
gui_list_select -id Wave.1 -selected  { {tb_camera.cc.mv_cnt[31:0]}   }
gui_list_action -id  Wave.1 {tb_camera.cc.mv_cnt[31:0]}
gui_get_drivers -id Wave.1 -signal {tb_camera.cc.mv_cnt[31:0]}
gui_src_highlight_item -id Source.1 -lfrom 1 -idxfrom 0 -fileIdFrom 0 -lto 70 -idxto 1 -fileIdTo 0 -selection {
`default_nettype none
 
`ifndef LIBARAY_SV
`define LIBRARY_SV
module negedge_detector(

module shifter #(parameter W=8, RV={W{1'b0}}) (

module counter #(parameter W=8, RV={W{1'b0}}) (

module ff_ar_en #(parameter W=1, RV={W{1'b0}}) (

// flip flop with asynchronous reset
// bit width and reset value are parameters
module ff_ar #(parameter W=1, RV={W{1'b0}}) (
    output logic [W-1:0] q,
    input logic [W-1:0] d,
    input logic clk, rst);
 
    always @(posedge clk, posedge rst) begin
        if(rst)
            q <= RV;
        else
            q <= d;
    end
 
} -selectionId 0 -replace 0
gui_list_select -id Data.1 -selected  { tb_camera.cc.v2   }
gui_list_select -id Data.1 -selected  { {tb_camera.cc.key_val[2:0]}   }
gui_list_show_data -select -id  Data.1   {tb_camera.cc.key_val[2:0]}
gui_list_select -id Data.1 -selected  { {tb_camera.cc.mv_cnt_n[31:0]}   }
gui_list_add -id Wave.1 -from Data.1 { {tb_camera.cc.mv_cnt_n[31:0]} } -insertionbar
gui_marker_move -id  Wave.1 C1 1209
gui_marker_move -id  Wave.1 C1 1413
gui_marker_move -id  Wave.1 C1 1299
gui_list_select -id Wave.1 -selected  { tb_camera.cc.stop_cnt   }
gui_zoom -window  Wave.1  -full
gui_wv_zoom_timerange -id  Wave.1 281 3149
gui_wv_zoom_timerange -id  Wave.1 1803 2351
gui_wv_zoom_timerange -id  Wave.1 1920 2106
gui_marker_move -id  Wave.1 C1 2010
gui_list_select -id Wave.1 -selected  { tb_camera.cc.clr_cnt   }
gui_list_action -id  Hier.1 tb_camera.cc
gui_src_highlight_item -id Source.1 -lfrom 10 -idxfrom 23 -fileIdFrom 0 -lto 53 -idxto 23 -fileIdTo 0 -selection {
  output logic render_frame,
  output vector_t E, U, V, W
 
  );
 
  // left right U
  // left = key_d   0
  // right = key_a  1
 
  // up/down V  
  // up = E         2
  // down = Q       3
 
  // in/out W       
  // in = W_key     4
  // out = S_key    5
  
 
  enum logic[1:0] {NOT_PRESSED, PRESSED, RENDERING} CS0, NS0;
 
  logic rendering, rendering_n;
  logic pressed, released, ld_key_val;
  logic[2:0] key_val_n, key_val; 
  
  assign rendering_n = rendering_done ? 1'b0 : (render_frame ? 1'b1 : rendering);
  assign pressed = (CS0 == PRESSED);
  assign released = ~pressed;
 
 
  ff_ar #(1,'h0) ffrend(.q(rendering), .d(rendering_n), .clk, .rst);
 
 
  always_comb begin
    ld_key_val = 1'b0;
    case(CS0)
      NOT_PRESSED : begin
        NS0 = keys.pressed ? PRESSED : NOT_PRESSED ;
        ld_key_val = keys.pressed ;
      end
      PRESSED : begin
        NS0 = keys.released ? RENDERING : PRESSED ;
      end
      RENDERING : begin} -selectionId 0 -replace 0
gui_src_highlight_item -id Source.1 -lfrom 21 -idxfrom 21 -fileIdFrom 0 -lto 23 -idxto 1 -fileIdTo 0 -selection {
  // down = Q       3
 
} -selectionId 0 -replace 0
gui_src_highlight_item -id Source.1 -lfrom 14 -idxfrom 4 -fileIdFrom 0 -lto 59 -idxto 52 -fileIdTo 0 -selection {
 
  // left right U
  // left = key_d   0
  // right = key_a  1
 
  // up/down V  
  // up = E         2
  // down = Q       3
 
  // in/out W       
  // in = W_key     4
  // out = S_key    5
  
 
  enum logic[1:0] {NOT_PRESSED, PRESSED, RENDERING} CS0, NS0;
 
  logic rendering, rendering_n;
  logic pressed, released, ld_key_val;
  logic[2:0] key_val_n, key_val; 
  
  assign rendering_n = rendering_done ? 1'b0 : (render_frame ? 1'b1 : rendering);
  assign pressed = (CS0 == PRESSED);
  assign released = ~pressed;
 
 
  ff_ar #(1,'h0) ffrend(.q(rendering), .d(rendering_n), .clk, .rst);
 
 
  always_comb begin
    ld_key_val = 1'b0;
    case(CS0)
      NOT_PRESSED : begin
        NS0 = keys.pressed ? PRESSED : NOT_PRESSED ;
        ld_key_val = keys.pressed ;
      end
      PRESSED : begin
        NS0 = keys.released ? RENDERING : PRESSED ;
      end
      RENDERING : begin
        NS0 = rendering ? RENDERING : NOT_PRESSED ;
      end
    endcase
  end
 
  ff_ar #(2,2'b00) ff(.q(CS0), .d(NS0), .clk, .rst);} -selectionId 0 -replace 0
gui_list_action -id  Data.1 {tb_camera.cc.mv_cnt_n[31:0]}
gui_src_highlight_item -id Source.1 -lfrom 67 -idxfrom 38 -fileIdFrom 0 -lto 109 -idxto 19 -fileIdTo 0 -selection {
        6'b00_01_00 : key_val_n = 'h3;
        6'b00_00_10 : key_val_n = 'h4;
        6'b00_00_01 : key_val_n = 'h5;
      endcase
    end 
  end
  
  ff_ar #(3,'h0) ff0(.q(key_val), .d(key_val_n), .clk, .rst);
 
  
  logic [31:0] mv_cnt, mv_cnt_n;
  logic stop_cnt, start_cnt0, start_cnt25, clr_cnt;
  logic is_counting, is_counting_n;
 
  assign is_counting_n = stop_cnt ? 1'b0 : (start_cnt0 | start_cnt25 ? 1'b1 : is_counting);
  
  ff_ar #(1,1'b0) ff1(.q(is_counting), .d(is_counting_n), .clk, .rst);
  
  // TODO might be sketchy, check this shit
  always_comb begin
    mv_cnt_n = mv_cnt ;
    case({clr_cnt|start_cnt0,start_cnt25,stop_cnt,v2&is_counting})
      4'b1??? : mv_cnt_n = 'h0;
      4'b01?? : mv_cnt_n = 'd25;
      4'b001? : mv_cnt_n = mv_cnt ;
      4'b0001 : mv_cnt_n = mv_cnt + 3'h3 ;
    endcase
  end
 
  ff_ar #(32,'h0) ff2(.q(mv_cnt), .d(mv_cnt_n), .clk, .rst);
 
  logic [1:0] CS1, NS1 ;
  
  always_comb begin
    clr_cnt = 1'b0;
    start_cnt0 = 1'b0;
    start_cnt25 = 1'b0;
    clr_cnt = 1'b0;
    render_frame = 1'b0;
    stop_cnt = 1'b0;
    case(CS1)
      2'b00 : begin} -selectionId 0 -replace 0
gui_set_env SIMSETUP::SIMCURRENTDIR /afs/ece.cmu.edu/usr/rmacdona/18-545
gui_sim_restart -build /afs/ece.cmu.edu/usr/rmacdona/18-545/simv.daidir/vcs_rebuild
dump -add / -depth 0
run
gui_marker_move -id  Wave.1 C1 12095
gui_zoom -window  Wave.1  -full
gui_wv_zoom_timerange -id  Wave.1 0 4155
gui_wv_zoom_timerange -id  Wave.1 0 3084
gui_wv_zoom_timerange -id  Wave.1 2020 2034
gui_zoom -window  Wave.1  -full
gui_wv_zoom_timerange -id  Wave.1 0 4306
gui_marker_move -id  Wave.1 C1 2020
gui_sim_restart -build /afs/ece.cmu.edu/usr/rmacdona/18-545/simv.daidir/vcs_rebuild
gui_list_select -id Hier.1 -selected  { tb_camera   }
dump -add { tb_camera } -depth 0 -scope "."
run
gui_zoom -window  Wave.1  -full
gui_view_port_history -window Wave.1 -previous
gui_zoom -window  Wave.1  -full
gui_wv_zoom_timerange -id  Wave.1 0 1958
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scrollright -id  Wave.1  line
gui_wv_scroll_hslidermove -id  Wave.1 536
gui_sim_restart -build /afs/ece.cmu.edu/usr/rmacdona/18-545/simv.daidir/vcs_rebuild
dump -add { tb_camera } -depth 0 -scope "."
run
gui_zoom -window  Wave.1  -full
gui_wv_zoom_timerange -id  Wave.1 0 6497
gui_wv_zoom_timerange -id  Wave.1 0 4343
gui_close_window -window TopLevel.2
